<!doctype html><html><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><link rel=icon href=/fav.png type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:url" content="https://nikoltchovska.de/posts/ibm/"><meta property="og:site_name" content="Alexandra Nikoltchovska"><meta property="og:title" content="IBM Model 1 Machine Translation in Python"><meta property="og:description" content="The IBM model 1 is the original gangster of statistical machine translation. It can learn a dictionary between two languages from a number of translated sentences without any real understanding of language and with a complete disregard for word order.
Even though, we will see that is is able to get meaningful results even from small-ish training sets. While the usual way of explaining its working involves alignments, I find it much more intuitive to think about it as a variant of Von Mises Iteration. In both cases we iteratively move some kind of mass to the most probable solution. Constant normalization of the solution reinforces the most probable solution while suppressing less probable ones."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-18T10:31:00+02:00"><meta property="article:modified_time" content="2023-09-18T10:31:00+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="IBM Model 1 Machine Translation in Python"><meta name=twitter:description content="The IBM model 1 is the original gangster of statistical machine translation. It can learn a dictionary between two languages from a number of translated sentences without any real understanding of language and with a complete disregard for word order.
Even though, we will see that is is able to get meaningful results even from small-ish training sets. While the usual way of explaining its working involves alignments, I find it much more intuitive to think about it as a variant of Von Mises Iteration. In both cases we iteratively move some kind of mass to the most probable solution. Constant normalization of the solution reinforces the most probable solution while suppressing less probable ones."><link rel=stylesheet href=/bootstrap-5/css/bootstrap.min.css media=all><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--text-link-color:#007bff;--background-color:#eaedf0;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--text-link-color-dark:#ffffff;--background-color-dark:#18191a;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}html{background-color:var(--background-color)!important}body::-webkit-scrollbar{height:0;width:8px;background-color:var(--background-color)}::-webkit-scrollbar-track{border-radius:1rem}::-webkit-scrollbar-thumb{border-radius:1rem;background:#b0b0b0;outline:1px solid var(--background-color)}#search-content::-webkit-scrollbar{width:.5em;height:.1em;background-color:var(--background-color)}</style><meta name=description content><link rel=stylesheet href=/css/single.css><script defer src=/fontawesome-6/all-6.4.2.js></script><title>IBM Model 1 Machine Translation in Python | Alexandra Nikoltchovska</title></head><body class=light><script>let localStorageValue=localStorage.getItem("pref-theme"),mediaQuery=window.matchMedia("(prefers-color-scheme: dark)").matches;switch(localStorageValue){case"dark":document.body.classList.add("dark");break;case"light":document.body.classList.remove("dark");break;default:mediaQuery&&document.body.classList.add("dark");break}</script><script>var prevScrollPos=window.pageYOffset;window.addEventListener("scroll",function(){let s=document.getElementById("profileHeader"),t=window.pageYOffset,n=!1,o=!0,i=o?prevScrollPos>t:t>0;i?s.classList.add("showHeaderOnTop"):n=!0,t===0&&(n=!0),n&&s.classList.remove("showHeaderOnTop"),prevScrollPos=t})</script><header id=profileHeader><nav class="pt-3 navbar navbar-expand-lg animate"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/>Alexandra Nikoltchovska</a><div><input id=search autocomplete=off class="form-control mr-sm-2 d-none d-md-block" placeholder='Ctrl + k to Search...' aria-label=Search oninput=searchOnChange(event)></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text d-block d-md-none"><div class=nav-link><input id=search autocomplete=off class="form-control mr-sm-2" placeholder='Ctrl + k to Search...' aria-label=Search oninput=searchOnChange(event)></div></li><li class="nav-item navbar-text"><a class=nav-link href=/#experience aria-label=experience>Experience</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#education aria-label=education>Education</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#contact aria-label=contact>Contact</a></li><li class="nav-item navbar-text"><a class=nav-link href=/posts title="Blog posts">Blog</a></li><li class="nav-item navbar-text"><a class=nav-link href=/gallery title="Blog posts">Gallery</a></li><li class="nav-item navbar-text"><div class=text-center><button id=theme-toggle><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">IBM Model 1 Machine Translation in Python</h1><div class=text-center>Sep 18, 2023
<span id=readingTime>min read</span></div></div><article class="page-content p-2"><p>The IBM model 1 is the original gangster of statistical machine translation.
It can learn a dictionary between two languages from a number of translated sentences
without any real understanding of language and with a complete disregard for word order.</p><p>Even though, we will see that is is able to get meaningful results even from small-ish
training sets. While the usual way of explaining its working involves alignments, I find
it much more intuitive to think about it as a variant of <a href=https://en.wikipedia.org/wiki/Power_iteration>Von Mises Iteration</a>.
In both cases we iteratively move some kind of mass to the most probable solution. Constant
normalization of the solution reinforces the most probable solution while suppressing less
probable ones.</p><p>We start by asking ChatGPT for some translations:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>translations <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;hallo&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;hello&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;guten morgen&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;good morning&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;auf wiedersehen&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;goodbye&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;danke&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;thank you&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;bitte&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;please&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich esse gerne pizza.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i enjoy eating pizza.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;das ist ein leckeres gericht.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;this is a delicious dish.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;möchtest du zum abendessen gehen?&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;would you like to go for dinner?&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich trinke gerne kaffee am morgen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i like to have coffee in the morning.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;dieses restaurant serviert köstliche pasta.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;this restaurant serves delicious pasta.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich liebe schokoladeneis.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i love chocolate ice cream.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;kannst du mir bitte das salz reichen?&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;can you please pass me the salt?&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;wir haben gestern abend sushi gegessen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;we had sushi last night.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;das restaurant hat eine umfangreiche speisekarte.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the restaurant has an extensive menu.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich mag frisches gemüse in meinem salat.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i like fresh vegetables in my salad.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;kannst du bitte das dessert bestellen?&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;can you please order dessert?&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;das brot ist frisch aus dem ofen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the bread is fresh from the oven.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;meine oma macht die besten pfannkuchen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;my grandma makes the best pancakes.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;wir brauchen noch einige zutaten für das abendessen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;we need a few more ingredients for dinner.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;das ist ein traditionelles deutsches gericht.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;this is a traditional german dish.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich koche gerne italienische gerichte.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i enjoy cooking italian dishes.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;der kellner brachte uns die speisekarte.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the waiter brought us the menu.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich habe eine allergie gegen erdnüsse.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i have an allergy to peanuts.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;heute abend machen wir grillen im garten.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;tonight, we&#39;re having a barbecue in the garden.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich probiere gerne exotische gerichte.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i enjoy trying exotic dishes.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;die suppe ist noch heiß.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the soup is still hot.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich habe lust auf ein stück schokoladenkuchen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i&#39;m in the mood for a piece of chocolate cake.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;die kellnerin empfahl den fisch des tages.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the waitress recommended the fish of the day.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;wir haben gestern ein neues restaurant ausprobiert.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;we tried a new restaurant yesterday.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;die pizza ist mit peperoni und oliven belegt.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the pizza is topped with pepperoni and olives.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich esse lieber sushi mit stäbchen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i prefer eating sushi with chopsticks.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;das restaurant serviert authentische mexikanische tacos.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the restaurant serves authentic mexican tacos.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;möchtest du etwas zum knabbern während des films?&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;would you like something to snack on during the movie?&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich habe gestern abend spaghetti bolognese gekocht.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i cooked spaghetti bolognese last night.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;das brot schmeckt besonders gut mit butter.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the bread tastes especially good with butter.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;das restaurant hat eine tolle auswahl an vorspeisen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the restaurant has a great selection of appetizers.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;in der bäckerei gibt es frische croissants.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;there are fresh croissants available at the bakery.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;die suppe ist gut gewürzt und heiß.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the soup is well-seasoned and hot.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich habe einen tisch für zwei personen reserviert.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i&#39;ve reserved a table for two people.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;heute abend bestellen wir chinesisches essen.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;tonight, we&#39;re ordering chinese food.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;kannst du mir bitte das salatdressing reichen?&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;can you please pass me the salad dressing?&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ich habe eine vorliebe für scharfe gerichte.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;i have a preference for spicy dishes.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;das restaurant bietet vegetarische optionen an.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the restaurant offers vegetarian options.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;die kuchen in dieser bäckerei sind unwiderstehlich.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;the cakes at this bakery are irresistible.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;wir planen eine grillparty am samstag.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;we&#39;re planning a barbecue party on saturday.&#34;</span>,
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># do some simple normalization and tokenization</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pre</span>(s: str) <span style=color:#f92672>-&gt;</span> list[str]:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;,&#34;</span>, <span style=color:#e6db74>&#34; &#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;.&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;?&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)<span style=color:#f92672>.</span>lower()<span style=color:#f92672>.</span>split()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># we also swap the tuples so e=english and f=foreign (as is customary for IBM models)</span>
</span></span><span style=display:flex><span>translations <span style=color:#f92672>=</span> [(pre(e), pre(d)) <span style=color:#66d9ef>for</span> d, e <span style=color:#f92672>in</span> translations]
</span></span></code></pre></div><p>The implementation follows the pseudocode of <a href=https://www2.statmt.org/book/>Philipp Koehns Slides</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> defaultdict
</span></span><span style=display:flex><span>t <span style=color:#f92672>=</span> defaultdict(<span style=color:#66d9ef>lambda</span>: defaultdict(<span style=color:#66d9ef>lambda</span>: <span style=color:#ae81ff>0.1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>100</span>):
</span></span><span style=display:flex><span>    count <span style=color:#f92672>=</span> defaultdict(<span style=color:#66d9ef>lambda</span>: defaultdict(float))
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> defaultdict(float)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    all_words_e <span style=color:#f92672>=</span> set(word <span style=color:#66d9ef>for</span> sentence, _ <span style=color:#f92672>in</span> translations <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> sentence)
</span></span><span style=display:flex><span>    all_words_f <span style=color:#f92672>=</span> set(word <span style=color:#66d9ef>for</span> _, sentence <span style=color:#f92672>in</span> translations <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> sentence)
</span></span><span style=display:flex><span>    s_total <span style=color:#f92672>=</span> defaultdict(float)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> e, f <span style=color:#f92672>in</span> translations:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># calculate how much probability mass each english word will recieve</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> we <span style=color:#f92672>in</span> e:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> wf <span style=color:#f92672>in</span> f:
</span></span><span style=display:flex><span>                s_total[we] <span style=color:#f92672>+=</span> t[we][wf]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># collect</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> we <span style=color:#f92672>in</span> e:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> wf <span style=color:#f92672>in</span> f:
</span></span><span style=display:flex><span>                <span style=color:#75715e># give each english word its probability mass</span>
</span></span><span style=display:flex><span>                count[we][wf] <span style=color:#f92672>+=</span> t[we][wf] <span style=color:#f92672>/</span> s_total[we]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># keep track how much probability mass each foreign word gave away</span>
</span></span><span style=display:flex><span>                total[wf] <span style=color:#f92672>+=</span> t[we][wf] <span style=color:#f92672>/</span> s_total[we]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># estimate probabilities</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> wf <span style=color:#f92672>in</span> all_words_f:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> we <span style=color:#f92672>in</span> all_words_e:
</span></span><span style=display:flex><span>            <span style=color:#75715e># normalize t(e|f), so that \sum_f t(e|f) = 1 for all e, ie we get proper probability distributions.</span>
</span></span><span style=display:flex><span>            t[we][wf] <span style=color:#f92672>=</span> count[we][wf] <span style=color:#f92672>/</span> total[wf]
</span></span></code></pre></div><p>Finally, dump our dictionary:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>words_f <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>words_e <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> e, f <span style=color:#f92672>in</span> translations:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> we <span style=color:#f92672>in</span> e:
</span></span><span style=display:flex><span>        words_e<span style=color:#f92672>.</span>add(we)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> wf <span style=color:#f92672>in</span> f:
</span></span><span style=display:flex><span>        words_f<span style=color:#f92672>.</span>add(wf)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> we <span style=color:#f92672>in</span> words_e:
</span></span><span style=display:flex><span>    prob, wf <span style=color:#f92672>=</span> max((t[we][wf], wf) <span style=color:#66d9ef>for</span> wf <span style=color:#f92672>in</span> words_f)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> prob <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.9</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># skip unconverged words</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>we<span style=color:#e6db74>}</span><span style=color:#e6db74> -&gt; </span><span style=color:#e6db74>{</span>wf<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#ae81ff>\t</span><span style=color:#e6db74> (</span><span style=color:#e6db74>{</span>prob<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span>)
</span></span></code></pre></div><p>The result is pretty impressive, the overwhelming majority of translations are solid:</p><pre tabindex=0><code>extensive -&gt; umfangreiche 	 (0.99)
is -&gt; ist 	 (1.00)
hello -&gt; hallo 	 (1.00)
good -&gt; guten 	 (0.99)
and -&gt; und 	 (1.00)
can -&gt; kannst 	 (1.00)
had -&gt; gegessen 	 (0.99)
dressing -&gt; salatdressing 	 (1.00)
pizza -&gt; pizza 	 (1.00)
eating -&gt; esse 	 (1.00)
serves -&gt; serviert 	 (1.00)
goodbye -&gt; wiedersehen 	 (1.00)
sushi -&gt; sushi 	 (1.00)
please -&gt; bitte 	 (1.00)
dishes -&gt; gerichte 	 (1.00)
an -&gt; eine 	 (0.99)
bread -&gt; brot 	 (1.00)
enjoy -&gt; gerne 	 (0.94)
has -&gt; hat 	 (1.00)
well-seasoned -&gt; gewürzt 	 (1.00)
restaurant -&gt; restaurant 	 (1.00)
menu -&gt; speisekarte 	 (1.00)
salt -&gt; salz 	 (0.99)
with -&gt; mit 	 (1.00)
morning -&gt; morgen 	 (1.00)
</code></pre></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div id=stickySideBar class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents></nav></div></aside><aside class=social><h5>Social</h5><div class=social-content><ul class=list-inline><li class="list-inline-item text-center"><a target=_blank href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnikoltchovska.de%2fposts%2fibm%2f"><i class="fab fa-linkedin"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://twitter.com/share?text=IBM%20Model%201%20Machine%20Translation%20in%20Python&url=https%3a%2f%2fnikoltchovska.de%2fposts%2fibm%2f"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://api.whatsapp.com/send?text=IBM%20Model%201%20Machine%20Translation%20in%20Python: https%3a%2f%2fnikoltchovska.de%2fposts%2fibm%2f"><i class="fab fa-whatsapp"></i></a></li><li class="list-inline-item text-center"><a target=_blank href='mailto:?subject=IBM%20Model%201%20Machine%20Translation%20in%20Python&amp;body=Check%20out%20this%20site https%3a%2f%2fnikoltchovska.de%2fposts%2fibm%2f'><i class="fa fa-envelope"></i></a></li></ul></div></aside></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><div class=progress><div id=scroll-progress-bar class=progress-bar role=progressbar aria-valuenow=0 aria-valuemin=0 aria-valuemax=100></div></div><script src=/js/scrollProgressBar.js></script><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}let stickySideBarElem=document.getElementById("stickySideBar"),stickyNavBar=!0;if(stickyNavBar){let e=document.getElementById("profileHeader"),t=e.offsetHeight+15;stickySideBarElem.style.top=t+"px"}else stickySideBarElem.style.top="50px"</script><script src=/js/readingTime.js></script></div><footer><div class="text-center pt-2"><span class=px-1><a href=https://github.com aria-label=github><svg width="2.7em" height="2.7em" viewBox="0 0 1792 1792"><path id="footer-socialNetworks-github-svg-path" d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5T1376 1664h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"/></svg>
</a></span><span class=px-1><a href=https://linkedin.com aria-label=linkedin><svg width="2.4em" height="2.4em" fill="#fff" aria-label="LinkedIn" viewBox="0 0 512 512"><rect width="512" height="512" fill="#0077b5" rx="15%"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
</a></span><a href=https://twitter.com aria-label=twitter><svg viewBox="0 0 48 48" width="48" height="48"><path fill="#03a9f4" d="M42 37c0 2.762-2.239 5-5 5H11c-2.762.0-5-2.238-5-5V11c0-2.762 2.238-5 5-5h26c2.761.0 5 2.238 5 5V37z"/><path fill="#fff" d="M36 17.12c-.882.391-1.999.758-3 .88 1.018-.604 2.633-1.862 3-3-.951.559-2.671 1.156-3.793 1.372C31.311 15.422 30.033 15 28.617 15 25.897 15 24 17.305 24 20v2c-4 0-7.9-3.047-10.327-6-.427.721-.667 1.565-.667 2.457.0 1.819 1.671 3.665 2.994 4.543-.807-.025-2.335-.641-3-1 0 .016.0.036.0.057.0 2.367 1.661 3.974 3.912 4.422C16.501 26.592 16 27 14.072 27c.626 1.935 3.773 2.958 5.928 3-1.686 1.307-4.692 2-7 2-.399.0-.615.022-1-.023C14.178 33.357 17.22 34 20 34c9.057.0 14-6.918 14-13.37.0-.212-.007-.922-.018-1.13C34.95 18.818 35.342 18.104 36 17.12"/></svg>
</a><a href=https://instagram.com aria-label=instagram><svg viewBox="0 0 48 48" width="48" height="48"><radialGradient id="yOrnnhliCrdS2gy~4tD8ma" cx="19.38" cy="42.035" r="44.899" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#fd5"/><stop offset=".328" stop-color="#ff543f"/><stop offset=".348" stop-color="#fc5245"/><stop offset=".504" stop-color="#e64771"/><stop offset=".643" stop-color="#d53e91"/><stop offset=".761" stop-color="#cc39a4"/><stop offset=".841" stop-color="#c837ab"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8ma)" d="M34.017 41.99l-20 .019c-4.4.004-8.003-3.592-8.008-7.992l-.019-20c-.004-4.4 3.592-8.003 7.992-8.008l20-.019c4.4-.004 8.003 3.592 8.008 7.992l.019 20C42.014 38.383 38.417 41.986 34.017 41.99z"/><radialGradient id="yOrnnhliCrdS2gy~4tD8mb" cx="11.786" cy="5.54" r="29.813" gradientTransform="matrix(1 0 0 .6663 0 1.849)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#4168c9"/><stop offset=".999" stop-color="#4168c9" stop-opacity="0"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8mb)" d="M34.017 41.99l-20 .019c-4.4.004-8.003-3.592-8.008-7.992l-.019-20c-.004-4.4 3.592-8.003 7.992-8.008l20-.019c4.4-.004 8.003 3.592 8.008 7.992l.019 20C42.014 38.383 38.417 41.986 34.017 41.99z"/><path fill="#fff" d="M24 31c-3.859.0-7-3.14-7-7s3.141-7 7-7 7 3.14 7 7-3.141 7-7 7zm0-12c-2.757.0-5 2.243-5 5s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5z"/><circle cx="31.5" cy="16.5" r="1.5" fill="#fff"/><path fill="#fff" d="M30 37H18c-3.859.0-7-3.14-7-7V18c0-3.86 3.141-7 7-7h12c3.859.0 7 3.14 7 7v12c0 3.86-3.141 7-7 7zM18 13c-2.757.0-5 2.243-5 5v12c0 2.757 2.243 5 5 5h12c2.757.0 5-2.243 5-5V18c0-2.757-2.243-5-5-5H18z"/></svg>
</a><a href=https://facebook.com aria-label=facebook><svg viewBox="0 0 48 48" width="48" height="48"><path fill="#3f51b5" d="M42 37c0 2.762-2.238 5-5 5H11c-2.761.0-5-2.238-5-5V11c0-2.762 2.239-5 5-5h26c2.762.0 5 2.238 5 5V37z"/><path fill="#fff" d="M34.368 25H31v13h-5V25h-3v-4h3v-2.41c.002-3.508 1.459-5.59 5.592-5.59H35v4h-2.287C31.104 17 31 17.6 31 18.723V21h4L34.368 25z"/></svg></a></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://nikoltchovska.de/ title="Alexandra Nikoltchovska"><img alt="Footer logo" src=/fav.png height=40px width=40px></a></div>&copy; 2025 All rights reserved<div class=text-secondary>Made with
<span class=text-danger>&#10084;
</span>and
<a href=https://github.com/gurusabarish/hugo-profile target=_blank title="Designed and developed by gurusabarish">Hugo Profile</a></div></div></div></div></footer><script src=/bootstrap-5/js/bootstrap.bundle.min.js></script><script>document.body.className.includes("light")&&(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))});var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map(function(e){return new bootstrap.Tooltip(e)})</script><script src=/js/search.js></script><section id=search-content class=py-2><div class=container id=search-results></div></section></body></html>